"use strict";var k=Object.defineProperty,_=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;var E=(e,o,a)=>o in e?k(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,N=(e,o)=>{for(var a in o||(o={}))K.call(o,a)&&E(e,a,o[a]);if(y)for(var a of y(o))m.call(o,a)&&E(e,a,o[a]);return e},R=(e,o)=>_(e,j(o));var w=(e,o)=>{var a={};for(var u in e)K.call(e,u)&&o.indexOf(u)<0&&(a[u]=e[u]);if(e!=null&&y)for(var u of y(e))o.indexOf(u)<0&&m.call(e,u)&&(a[u]=e[u]);return a};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const b=require("react"),A=require("prop-types"),L=require("../Box/Box.cjs"),f=require("../helpers/getFocusableNodes.cjs"),i=require("../helpers/keyboardKeys.cjs"),O=require("./RawTableContext.cjs"),F=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},v=F(b),n=F(A),T=e=>v.default.createElement(h,R(N({},e),{as:"th"})),h=u=>{var x=u,{coords:e,as:o}=x,a=w(x,["coords","as"]);const l=b.useRef(null),{rowIndex:B,colIndex:I,setTableValues:P}=O.useTable(),[d,p]=b.useState(!1),q=t=>{const s=f.getFocusableNodes(l.current,!0);if(!(s.length===0||s.length===1&&f.getFocusableNodesWithKeyboardNav(s).length===0)){if(s.length>1&&!Boolean(s.find(r=>r.tagName!=="BUTTON"))){t.preventDefault();const r=s.findIndex(c=>c===document.activeElement);if(t.key===i.KeyboardKeys.RIGHT){const c=s[r+1];c&&(t.stopPropagation(),c.focus())}else if(t.key===i.KeyboardKeys.LEFT){const c=s[r-1];c&&(t.stopPropagation(),c.focus())}return}t.key===i.KeyboardKeys.ENTER&&!d?p(!0):(t.key===i.KeyboardKeys.ESCAPE||t.key===i.KeyboardKeys.ENTER)&&d?(p(!1),l.current.focus()):d&&t.stopPropagation()}},g=B===e.row-1&&I===e.col-1;return b.useLayoutEffect(()=>{const t=f.getFocusableNodes(l.current,!0);t.length===0||t.length===1&&f.getFocusableNodesWithKeyboardNav(t).length!==0||t.length>1&&Boolean(t.find(s=>s.tagName!=="BUTTON"))?(l.current.setAttribute("tabIndex",!d&&g?0:-1),t.forEach((s,r)=>{s.setAttribute("tabIndex",d?0:-1),d&&r===0&&s.focus()})):t.forEach(s=>{s.setAttribute("tabIndex",g?0:-1)})},[d,g]),b.useLayoutEffect(()=>{const t=f.getFocusableNodes(l.current,!0),s=()=>{t.length>=1&&(f.getFocusableNodesWithKeyboardNav(t).length!==0||!Boolean(t.find(r=>r.tagName!=="BUTTON")))&&p(!0),P({rowIndex:e.row-1,colIndex:e.col-1})};return t.forEach(r=>{r.addEventListener("focus",s)}),()=>{f.getFocusableNodes(l.current,!0).forEach(c=>{c.removeEventListener("focus",s)})}},[]),v.default.createElement(L.Box,N({as:o||"td",ref:l,onKeyDown:q},a))};T.defaultProps={coords:{}};T.propTypes={["aria-colindex"]:n.default.number.isRequired,children:n.default.node,coords:n.default.shape({col:n.default.number,row:n.default.number})};h.defaultProps={coords:{}};h.propTypes={["aria-colindex"]:n.default.number.isRequired,as:n.default.oneOf(["td","th"]),children:n.default.node,coords:n.default.shape({col:n.default.number,row:n.default.number})};exports.RawTd=h;exports.RawTh=T;
