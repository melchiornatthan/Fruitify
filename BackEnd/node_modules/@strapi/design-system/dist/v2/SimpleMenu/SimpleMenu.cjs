"use strict";var G=Object.defineProperty;var P=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var M=(e,s,t)=>s in e?G(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,m=(e,s)=>{for(var t in s||(s={}))O.call(s,t)&&M(e,t,s[t]);if(P)for(var t of P(s))R.call(s,t)&&M(e,t,s[t]);return e};var S=(e,s)=>{var t={};for(var r in e)O.call(e,r)&&s.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&P)for(var r of P(e))s.indexOf(r)<0&&R.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("react"),H=require("prop-types"),J=require("styled-components"),Q=require("@strapi/icons/CarretDown"),j=require("../../Typography/Typography.cjs"),q=require("../../Box/Box.cjs"),X=require("../../Flex/Flex.cjs"),_=require("../../Button/Button.cjs"),Y=require("../../BaseLink/BaseLink.cjs"),L=require("../../Popover/Popover.cjs"),F=require("./utils.cjs"),Z=require("../../helpers/useId.cjs"),d=require("../../helpers/keyboardKeys.cjs"),b=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},a=b(l),o=b(H),T=b(J),ee=b(Q),te=T.default.button`
  border: none;
  padding: 0;
  background: transparent;
  cursor: pointer;
  ${F.getOptionStyle}
`,ne=T.default(Y.BaseLink)`
  text-decoration: none;
  ${F.getOptionStyle}
`,oe=T.default.span`
  display: flex;
  align-items: center;
  svg {
    height: 4px;
    width: 6px;
  }
`,se=T.default(_.Button)`
  padding: ${({theme:e})=>`${e.spaces[1]} ${e.spaces[3]}`};
`,C=v=>{var K=v,{as:e,children:s,onClick:t,isFocused:r,isLink:g}=K,h=S(K,["as","children","onClick","isFocused","isLink"]);const i=l.useRef();l.useEffect(()=>{r&&i.current&&i.current.focus()},[r]);const x=m({tabIndex:r?0:-1,ref:i,role:"menuitem"},h),k=c=>{(c.key===d.KeyboardKeys.SPACE||c.key===d.KeyboardKeys.ENTER)&&t()};return g?a.default.createElement(ne,m({as:e},x),a.default.createElement(q.Box,{padding:2},a.default.createElement(j.Typography,null,s))):a.default.createElement(te,m({onKeyDown:k,onMouseDown:t,type:"button"},x),a.default.createElement(q.Box,{padding:2},a.default.createElement(j.Typography,null,s)))};C.defaultProps={onClick:()=>{},isFocused:!1,isLink:!1};C.propTypes={as:o.default.elementType,children:o.default.node.isRequired,isFocused:o.default.bool,isLink:o.default.bool,onClick:o.default.func};const E=x=>{var k=x,{label:e,children:s,id:t,as:r,onOpen:g=()=>{},onClose:h=()=>{},size:v,popoverPlacement:K}=k,i=S(k,["label","children","id","as","onOpen","onClose","size","popoverPlacement"]);const c=l.useRef(),w=Z.useId("simplemenu",t),f=l.useRef(!1),[p,y]=l.useState(!1),[D,I]=l.useState(0),B=l.Children.toArray(s),A=v==="S"?se:_.Button,N=r||A;l.useEffect(()=>{if(["string","number"].includes(typeof e)){const n=B.findIndex(u=>u.props.children===e);n!==-1&&I(n)}},[e]),l.useEffect(()=>{f!=null&&f.current?p&&typeof g=="function"?g():typeof h=="function"&&h():f.current=!0},[f,p]),l.useEffect(()=>{a.default.isValidElement(e)&&D==-1&&c.current.focus()},[e,D]);const $=n=>{p&&(n.key===d.KeyboardKeys.ESCAPE&&(n.stopPropagation(),y(!1),c.current.focus()),n.key===d.KeyboardKeys.DOWN&&I(u=>u===B.length-1?0:u+1),n.key===d.KeyboardKeys.UP&&I(u=>u===0?B.length-1:u-1))},V=n=>{(n.key===d.KeyboardKeys.ENTER||n.key===d.KeyboardKeys.SPACE)&&y(u=>!u)},W=n=>{n.preventDefault(),n.currentTarget.contains(n.relatedTarget)||y(!1)},z=n=>{n.preventDefault(),y(u=>!u)},U=B.map((n,u)=>a.default.createElement(X.Flex,{as:"li",key:u,justifyContent:"center",role:"menuitem"},l.cloneElement(n,{onClick:()=>{n.props.onClick(),y(!1),c.current.focus()},isFocused:D===u})));return a.default.createElement("div",{onKeyDown:$},a.default.createElement(N,m({label:a.default.isValidElement(e)?null:e,"aria-haspopup":!0,"aria-expanded":p,"aria-controls":w,onKeyDown:V,onMouseDown:z,ref:c,type:"button",variant:"ghost",endIcon:a.default.createElement(oe,null,a.default.createElement(ee.default,{"aria-hidden":!0}))},i),e),p&&a.default.createElement(L.Popover,{onBlur:W,placement:K,source:c,spacing:4},a.default.createElement(q.Box,{role:"menu",as:"ul",padding:1,id:w},U)))};E.defaultProps={as:void 0};E.displayName="SimpleMenu";E.defaultProps={popoverPlacement:"bottom-start",size:"M"};E.propTypes={as:o.default.any,children:o.default.oneOfType([o.default.arrayOf(o.default.node),o.default.node]).isRequired,id:o.default.string,label:o.default.oneOfType([o.default.string,o.default.number,o.default.element]).isRequired,onClose:o.default.func,onOpen:o.default.func,popoverPlacement:o.default.oneOf(L.POPOVER_PLACEMENTS),size:o.default.oneOf(["S","M"])};exports.MenuItem=C;exports.SimpleMenu=E;
