"use strict";var ae=Object.defineProperty;var S=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var z=(l,a,o)=>a in l?ae(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,N=(l,a)=>{for(var o in a||(a={}))G.call(a,o)&&z(l,o,a[o]);if(S)for(var o of S(a))W.call(a,o)&&z(l,o,a[o]);return l};var J=(l,a)=>{var o={};for(var s in l)G.call(l,s)&&a.indexOf(s)<0&&(o[s]=l[s]);if(l!=null&&S)for(var s of S(l))a.indexOf(s)<0&&W.call(l,s)&&(o[s]=l[s]);return o};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const p=require("react"),se=require("prop-types"),ce=require("@strapi/icons/CarretDown"),ie=require("@strapi/icons/Cross"),de=require("../themes/sizes.cjs"),ue=require("./SelectButton.cjs"),fe=require("../Field/Field.cjs"),pe=require("../Field/FieldLabel.cjs");require("../Field/FieldInput.cjs");const ye=require("../Field/FieldHint.cjs"),he=require("../Field/FieldError.cjs");require("../Field/FieldContext.cjs");require("../Field/FieldAction.cjs");const me=require("../Popover/Popover.cjs"),Ee=require("../Stack/Stack.cjs"),K=require("../Typography/Typography.cjs"),L=require("../Flex/Flex.cjs"),Q=require("../Box/Box.cjs"),be=require("../helpers/useId.cjs"),ge=require("./SelectList.cjs"),O=require("./components.cjs"),qe=require("./hooks/useButtonRef.cjs"),U=require("../VisuallyHidden/VisuallyHidden.cjs"),Fe=require("./constants.cjs"),V=require("../helpers/escapeSelector.cjs"),je=require("./SelectTags.cjs"),Se=require("styled-components"),m=l=>l&&typeof l=="object"&&"default"in l?l:{default:l},n=m(p),e=m(se),ve=m(ce),xe=m(ie),Be=m(Se),Te=Be.default(L.Flex)`
  width: 100%;
`,R=Ce=>{var D=Ce,{label:l,labelAction:a,id:o,children:s,customizeContent:E,placeholder:v,onChange:x,value:r,hint:B,error:h,disabled:u,clearLabel:X,onClear:_,onReachEnd:Y,multi:i,required:Z,size:ee,startIcon:$,withTags:b}=D,te=J(D,["label","labelAction","id","children","customizeContent","placeholder","onChange","value","hint","error","disabled","clearLabel","onClear","onReachEnd","multi","required","size","startIcon","withTags"]);const c=be.useId("select",o),[g,q]=p.useState(void 0),k=qe.useButtonRef(g),w=p.useRef(null),T=`${c}-label`,F=`${c}-content`,le=h?`${c}-error`:B?`${c}-hint`:void 0;if(b&&!i)throw new Error('The "withTags" props can only be used when the "multi" prop is present');const ne=()=>{q(void 0)},re=()=>{u||(_(),k.current.focus())},H=t=>{t.preventDefault(),!u&&(t.nativeEvent.which===3||t.nativeEvent.button===2||q(Fe.DownState.Mouse))},C=(t,d=!0)=>{i?x(r.includes(t)?r.filter(y=>y!==t):[...r,t]):(x(t),d&&q(void 0))},M=t=>{x(r.includes(t[0])?r.filter(function(d){return this.indexOf(d)<0},t):[...r,...t])};let I,P=[];const A=(t,d)=>{const y=`${c}-option-${t.props.value}`,j=i?r.includes(t.props.value):t.props.value===r;return j&&(b?P.push({label:t.props.children,value:t.props.value}):I=t.props.children),p.cloneElement(t,{id:V.escapeSelector(y),onClick:()=>C(t.props.value),selected:j,multi:i,isChild:d})},oe=p.Children.toArray(s).map(t=>{if(t.type.displayName==="OptGroup"){const d=`${c}-option-${t.props.label}`,y=t.props.children.every(f=>r.includes(f.props.value)),j=!y&&t.props.children.some(f=>r.includes(f.props.value));return p.cloneElement(t,{id:V.escapeSelector(d),onClick:()=>M(t.props.children.map(f=>f.props.value)),selected:y,indeterminate:j,multi:i,children:p.Children.toArray(t.props.children).map(f=>A(f,!0)),value:t.props.label})}else return A(t)});return n.default.createElement(fe.Field,{hint:B,error:h,id:c},n.default.createElement(Ee.Stack,{spacing:l||B||h?1:0},l&&n.default.createElement(pe.FieldLabel,{required:Z,as:"span",id:T,action:a},l),n.default.createElement(O.SelectButtonWrapper,{size:ee,hasError:Boolean(h),disabled:u,ref:w},n.default.createElement(ue.SelectButton,N({ref:k,labelledBy:`${T} ${F}`,"aria-describedby":le,expanded:Boolean(g),onTrigger:q,id:c,hasError:Boolean(h),disabled:u,onMouseDown:H},te)),n.default.createElement(Te,{justifyContent:"space-between"},n.default.createElement(L.Flex,null,$&&n.default.createElement(Q.Box,{paddingLeft:3,"aria-hidden":!0},$),b&&n.default.createElement(je.SelectTags,{tags:P,onRemoveTag:C,disabled:u}),n.default.createElement(Q.Box,{paddingLeft:4,paddingRight:4},b?n.default.createElement(n.default.Fragment,null,!r||r.length===0?n.default.createElement(K.Typography,{ellipsis:!0,id:F,textColor:"neutral600"},v):null,n.default.createElement(U.VisuallyHidden,{as:"span",id:F},E?E(r):I||v,r.join(", "))):n.default.createElement(K.Typography,{ellipsis:!0,id:F,textColor:r?"neutral800":"neutral600"},E?E(r):I||v,i&&n.default.createElement(U.VisuallyHidden,{as:"span"},r.join(", "))))),n.default.createElement(L.Flex,null,(i&&r&&r.length||!i&&r)&&_&&n.default.createElement(O.IconBox,{as:"button",type:"button",onClick:re,"aria-label":X,"aria-disabled":u},n.default.createElement(xe.default,null)),n.default.createElement(O.CaretBox,{paddingLeft:3,"aria-hidden":!0,as:"button",type:"button",onMouseDown:H,tabIndex:-1,disabled:u},n.default.createElement(ve.default,null))))),n.default.createElement(ye.FieldHint,null),n.default.createElement(he.FieldError,null)),g&&n.default.createElement(me.Popover,{source:w,spacing:4,fullWidth:!0,intersectionId:`select-list-intersection-${c}`,onReachEnd:Y},n.default.createElement(ge.SelectList,{selectId:c,labelledBy:l?T:void 0,onEscape:ne,expanded:g,onSelectItem:(t,d)=>d?M(t):C(t,!1),multi:i},oe)))};R.defaultProps={"aria-label":void 0,children:[],clearLabel:"Clear",customizeContent:void 0,disabled:!1,id:void 0,label:void 0,labelAction:void 0,multi:!1,onChange:()=>{},onClear:void 0,onReachEnd:void 0,value:void 0,hint:void 0,error:void 0,placeholder:"Select...",required:!1,size:"M",startIcon:void 0,withTags:!1};R.propTypes={"aria-label":e.default.string,children:e.default.oneOfType([e.default.arrayOf(e.default.node),e.default.node]),clearLabel:e.default.string,customizeContent:e.default.func,disabled:e.default.bool,error:e.default.string,hint:e.default.oneOfType([e.default.string,e.default.node,e.default.arrayOf(e.default.node)]),id:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.string,labelAction:e.default.element,multi:e.default.bool,onChange:e.default.func,onClear:e.default.func,onReachEnd:e.default.func,placeholder:e.default.string,required:e.default.bool,size:e.default.oneOf(Object.keys(de.sizes.input)),startIcon:e.default.element,value:e.default.oneOfType([e.default.arrayOf(e.default.oneOfType([e.default.string,e.default.number])),e.default.string,e.default.number]),withTags:e.default.bool};exports.Select=R;
